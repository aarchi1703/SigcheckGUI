# SigcheckGUI

---

SigcheckGUI — это графический интерфейс для утилиты Sigcheck, позволяющий анализировать исполняемые файлы, проверять их подписи, энтропию, а также получать результаты проверки через VirusTotal.

### Возможности

- **Проверка подписи:** Анализ цифровой подписи файлов, проверка издателя и даты подписания.
- **Энтропия:** Расчет общей энтропии файла и энтропии отдельных секций PE-файла.
- **VirusTotal:** Интеграция с VirusTotal для проверки файлов на наличие вредоносного ПО.
- **Настраиваемые алармы:** Гибкая настройка уведомлений для различных параметров (подпись, энтропия, VT detection и т.д.).
- **Экспорт отчетов:** Сохранение результатов анализа в текстовый файл на русском или английском языке.

### Требования

- .NET Framework 4.7 или выше
- Утилита Sigcheck (встроена в проект)

### Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/aarchi1703/SigWPF.git
   ```
2. Откройте решение в Visual Studio и соберите проект.

### Использование

1. Запустите приложение.
2. Выберите файл для анализа через кнопку "Выбрать файл" или перетащите файл в окно приложения.
3. Просмотрите результаты анализа во вкладках:
   - All Info (-a): Общая информация о файле
   - Catalog Content (-d): Содержимое каталога
   - Hashes (-h): Хеши файла
   - Manifest (-m): Манифест
   - Version Number (-n): Номер версии
   - VirusTotal (-v): Результаты проверки VirusTotal
   - Энтропия: Расчет энтропии файла и его секций

### Настройка алармов

В настройках приложения можно настроить уведомления для различных параметров:
- Подпись файла
- Дата подписания
- Обнаружение VirusTotal
- Энтропия файла и секций
- Версии файла
- И другие параметры


# YARA Правила в SigcheckGUI

## Обзор

SigcheckGUI теперь поддерживает интеграцию с YARA правилами для расширенного анализа файлов. Система автоматически загружает и применяет YARA правила при запуске приложения и при выборе файлов для анализа.

## Основные возможности

### 1. Автоматическая загрузка правил
- При запуске приложения автоматически загружаются все сохраненные YARA правила
- Создается объединенный файл правил для более эффективного сканирования
- Правила применяются автоматически при выборе файла

### 2. Управление правилами
- Добавление новых YARA правил через настройки
- Включение/отключение отдельных правил
- Удаление ненужных правил
- Автоматическое обновление объединенного файла при изменении настроек

### 3. Валидация правил
- Проверка синтаксиса YARA правил
- Валидация существования файлов правил
- Подробный отчет о состоянии правил

### 4. Эффективное сканирование
- Использование объединенного файла правил для быстрого сканирования
- Fallback на индивидуальное сканирование при ошибках
- Подробные отчеты о результатах сканирования

## Настройка YARA правил

### 1. Добавление правил
1. Откройте настройки (кнопка "Настройки")
2. Перейдите в раздел "YARA-правила"
3. Нажмите "Добавить правило"
4. Выберите файл с YARA правилами (*.yar, *.yara, *.txt)
5. Добавьте описание правила
6. Включите/отключите правило по необходимости

### 2. Управление правилами
- **Включить/отключить**: Используйте чекбокс рядом с правилом
- **Изменить файл**: Нажмите "Выбрать файл" для выбора другого файла правил
- **Удалить**: Нажмите "Удалить" для удаления правила

### 3. Автоматическое применение
- Все изменения применяются автоматически
- Объединенный файл правил обновляется при каждом изменении
- YARA-сканирование запускается автоматически при выборе файла

## Использование

### 1. Проверка правил
- **"Проверить YARA"** - быстрая проверка синтаксиса правил с пустым файлом
- **"Тест YARA"** - полная проверка правил с тестовым сканированием
- Результаты отображаются на вкладке "YARA"
- Проверяется синтаксис и существование файлов

### 2. Просмотр отчета
- Нажмите кнопку "Отчет YARA" для просмотра подробного отчета
- Отчет включает информацию о всех правилах и их статусе
- Показывает информацию об объединенном файле правил

### 3. Сканирование файлов
- YARA-сканирование запускается автоматически при выборе файла
- Результаты отображаются на вкладке "YARA"
- Поддерживается как объединенное, так и индивидуальное сканирование

## Файлы системы

### 1. Настройки правил
- `yara_rules.txt` - файл с настройками YARA правил
- Содержит информацию о путях, описаниях и статусе правил

### 2. Объединенный файл
- `combined_yara_rules.yar` - объединенный файл всех активных правил
- Автоматически создается и обновляется
- Используется для быстрого сканирования

### 3. Путь к объединенному файлу
- `combined_yara_path.txt` - содержит путь к объединенному файлу правил


## Требования

### 1. YARA Engine
- Файл `yara64.exe` должен находиться в папке с приложением
- Скачать можно с официального сайта: https://github.com/VirusTotal/yara/releases

### 2. Формат правил
- Поддерживаются файлы с расширениями: .yar, .yara, .txt
- Правила должны соответствовать синтаксису YARA

## Устранение неполадок

### 1. Ошибка "Не найден yara64.exe"
- Убедитесь, что файл `yara64.exe` находится в папке с приложением
- Скачайте актуальную версию с официального сайта

### 2. Ошибки синтаксиса правил
- Используйте кнопку "Проверить YARA" для диагностики
- Проверьте синтаксис правил в соответствии с документацией YARA
- Убедитесь, что файлы правил не повреждены

### 3. Правила не применяются
- Проверьте, что правила включены в настройках
- Убедитесь, что файлы правил существуют по указанным путям
- Используйте кнопку "Отчет YARA" для диагностики

## Дополнительные возможности

### 1. Автоматическое обновление
- Система автоматически обновляет объединенный файл при изменении правил
- Изменения применяются немедленно без перезапуска приложения

### 2. Эффективность
- Объединенный файл правил обеспечивает быстрое сканирование
- Fallback на индивидуальное сканирование при ошибках
- Минимальное влияние на производительность

### 3. Гибкость
- Поддержка любых YARA правил
- Возможность включения/отключения отдельных правил
- Простое управление через графический интерфейс

## Заключение

Интеграция YARA правил значительно расширяет возможности SigcheckGUI для анализа файлов. Система обеспечивает автоматическое применение правил, эффективное сканирование и удобное управление через графический интерфейс. 


### Автор

aarchi1703